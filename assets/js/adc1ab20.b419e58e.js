"use strict";(self.webpackChunkPikiwiDB_Pika_=self.webpackChunkPikiwiDB_Pika_||[]).push([[539],{1602:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>h,contentTitle:()=>r,default:()=>j,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var d=s(4848),n=s(8453);const t={title:"3.2.x \u6027\u80fd",sidebar_position:0},r=void 0,l={id:"\u6027\u80fd\u4e0e\u4f18\u5316/3.2.x \u6027\u80fd/index",title:"3.2.x \u6027\u80fd",description:"Performance\uff1a",source:"@site/docs/\u6027\u80fd\u4e0e\u4f18\u5316/3.2.x \u6027\u80fd/index.md",sourceDirName:"\u6027\u80fd\u4e0e\u4f18\u5316/3.2.x \u6027\u80fd",slug:"/\u6027\u80fd\u4e0e\u4f18\u5316/3.2.x \u6027\u80fd/",permalink:"/docs/\u6027\u80fd\u4e0e\u4f18\u5316/3.2.x \u6027\u80fd/",draft:!1,unlisted:!1,editUrl:"https://github.com/pikiwidb/website/tree/main/docs/\u6027\u80fd\u4e0e\u4f18\u5316/3.2.x \u6027\u80fd/index.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{title:"3.2.x \u6027\u80fd",sidebar_position:0},sidebar:"tutorialSidebar",previous:{title:"\u6027\u80fd\u4e0e\u4f18\u5316",permalink:"/docs/\u6027\u80fd\u4e0e\u4f18\u5316/"},next:{title:"Pika \u5185\u5b58\u4f7f\u7528",permalink:"/docs/\u6027\u80fd\u4e0e\u4f18\u5316/Pika \u5185\u5b58\u4f7f\u7528/"}},h={},c=[{value:"Performance\uff1a",id:"performance",level:2},{value:"0. Env",id:"0-env",level:3},{value:"1. Single Db",id:"1-single-db",level:3},{value:"1.1 Write binlog with one slave",id:"11-write-binlog-with-one-slave",level:4},{value:"1.2 No binlog No slave",id:"12-no-binlog-no-slave",level:4},{value:"1.3 Benchmark Result",id:"13-benchmark-result",level:4},{value:"1.4 Compare Wiht Redis",id:"14-compare-wiht-redis",level:4},{value:"2. Cluster (Codis)",id:"2-cluster-codis",level:3},{value:"2.1 Topology:",id:"21-topology",level:4},{value:"2.2 WithBinlog&amp;Slave",id:"22-withbinlogslave",level:4},{value:"2.3 NoBinlog&amp;Slave",id:"23-nobinlogslave",level:4},{value:"2.4 Get Command",id:"24-get-command",level:4}];function x(e){const i={code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.h2,{id:"performance",children:"Performance\uff1a"}),"\n",(0,d.jsx)(i.h3,{id:"0-env",children:"0. Env"}),"\n",(0,d.jsx)(i.p,{children:"Disk: 2T NVME"}),"\n",(0,d.jsx)(i.p,{children:"CPU: Intel(R) Xeon(R) CPU E5-2630 v4 @ 2.20GHz * 40"}),"\n",(0,d.jsx)(i.p,{children:"Memory: 256G"}),"\n",(0,d.jsx)(i.p,{children:"Network Card: 10-Gigabit"}),"\n",(0,d.jsx)(i.p,{children:"OS\uff1a CentOS Linux release 7.4"}),"\n",(0,d.jsx)(i.h3,{id:"1-single-db",children:"1. Single Db"}),"\n",(0,d.jsx)(i.h4,{id:"11-write-binlog-with-one-slave",children:"1.1 Write binlog with one slave"}),"\n",(0,d.jsx)(i.p,{children:"data size: 64bytes"}),"\n",(0,d.jsx)(i.p,{children:"key num: 1,000,000"}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"TEST"}),(0,d.jsx)(i.th,{children:"QPS"})]})}),(0,d.jsxs)(i.tbody,{children:[(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"set"}),(0,d.jsx)(i.td,{children:"124347"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"get"}),(0,d.jsx)(i.td,{children:"283849"})]})]})]}),"\n",(0,d.jsx)(i.h4,{id:"12-no-binlog-no-slave",children:"1.2 No binlog No slave"}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{src:"https://whoiami.github.io/public/images/images/singleDb.png",alt:"singleDb"})}),"\n",(0,d.jsx)(i.h4,{id:"13-benchmark-result",children:"1.3 Benchmark Result"}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{}),(0,d.jsx)(i.th,{children:"WithBinlog&Slave QPS"}),(0,d.jsx)(i.th,{children:"NoBinlog&Slave QPS"})]})}),(0,d.jsxs)(i.tbody,{children:[(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"PING_INLINE"}),(0,d.jsx)(i.td,{children:"262329"}),(0,d.jsx)(i.td,{children:"272479"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"PING_BULK"}),(0,d.jsx)(i.td,{children:"262467"}),(0,d.jsx)(i.td,{children:"270562"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"SET"}),(0,d.jsx)(i.td,{children:"124953"}),(0,d.jsx)(i.td,{children:"211327"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"GET"}),(0,d.jsx)(i.td,{children:"284900"}),(0,d.jsx)(i.td,{children:"292568"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"INCR"}),(0,d.jsx)(i.td,{children:"120004"}),(0,d.jsx)(i.td,{children:"213766"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"MSET (10 keys)"}),(0,d.jsx)(i.td,{children:"64863"}),(0,d.jsx)(i.td,{children:"111578"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"MGET (10 keys)"}),(0,d.jsx)(i.td,{children:"224416"}),(0,d.jsx)(i.td,{children:"223513"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"MGET (100 keys)"}),(0,d.jsx)(i.td,{children:"29935"}),(0,d.jsx)(i.td,{children:"29550"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"MGET (200 keys)"}),(0,d.jsx)(i.td,{children:"15128"}),(0,d.jsx)(i.td,{children:"14912"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LPUSH"}),(0,d.jsx)(i.td,{children:"117799"}),(0,d.jsx)(i.td,{children:"205380"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"RPUSH"}),(0,d.jsx)(i.td,{children:"117481"}),(0,d.jsx)(i.td,{children:"205212"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LPOP"}),(0,d.jsx)(i.td,{children:"112120"}),(0,d.jsx)(i.td,{children:"200320"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"RPOP"}),(0,d.jsx)(i.td,{children:"119932"}),(0,d.jsx)(i.td,{children:"207986"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LRANGE_10 (first 10 elements)"}),(0,d.jsx)(i.td,{children:"277932"}),(0,d.jsx)(i.td,{children:"284414"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LRANGE_100 (first 100 elements)"}),(0,d.jsx)(i.td,{children:"165118"}),(0,d.jsx)(i.td,{children:"164355"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LRANGE_300 (first 300 elements)"}),(0,d.jsx)(i.td,{children:"54907"}),(0,d.jsx)(i.td,{children:"55096"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LRANGE_450 (first 450 elements)"}),(0,d.jsx)(i.td,{children:"36656"}),(0,d.jsx)(i.td,{children:"36630"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"LRANGE_600 (first 600 elements)"}),(0,d.jsx)(i.td,{children:"27540"}),(0,d.jsx)(i.td,{children:"27510"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"SADD"}),(0,d.jsx)(i.td,{children:"126230"}),(0,d.jsx)(i.td,{children:"208768"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"SPOP"}),(0,d.jsx)(i.td,{children:"103135"}),(0,d.jsx)(i.td,{children:"166555"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HSET"}),(0,d.jsx)(i.td,{children:"122443"}),(0,d.jsx)(i.td,{children:"214362"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HINCRBY"}),(0,d.jsx)(i.td,{children:"114757"}),(0,d.jsx)(i.td,{children:"208942"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HINCRBYFLOAT"}),(0,d.jsx)(i.td,{children:"114377"}),(0,d.jsx)(i.td,{children:"208550"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HGET"}),(0,d.jsx)(i.td,{children:"284900"}),(0,d.jsx)(i.td,{children:"290951"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HMSET (10 fields)"}),(0,d.jsx)(i.td,{children:"58937"}),(0,d.jsx)(i.td,{children:"111445"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HMGET (10 fields)"}),(0,d.jsx)(i.td,{children:"203624"}),(0,d.jsx)(i.td,{children:"205592"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"HGETALL"}),(0,d.jsx)(i.td,{children:"166861"}),(0,d.jsx)(i.td,{children:"160797"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"ZADD"}),(0,d.jsx)(i.td,{children:"106780"}),(0,d.jsx)(i.td,{children:"189178"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"ZREM"}),(0,d.jsx)(i.td,{children:"112866"}),(0,d.jsx)(i.td,{children:"201938"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"PFADD"}),(0,d.jsx)(i.td,{children:"4708"}),(0,d.jsx)(i.td,{children:"4692"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"PFCOUNT"}),(0,d.jsx)(i.td,{children:"27412"}),(0,d.jsx)(i.td,{children:"27345"})]}),(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"PFMERGE"}),(0,d.jsx)(i.td,{children:"478"}),(0,d.jsx)(i.td,{children:"494"})]})]})]}),"\n",(0,d.jsx)(i.h4,{id:"14-compare-wiht-redis",children:"1.4 Compare Wiht Redis"}),"\n",(0,d.jsxs)(i.p,{children:["With Redis AOF configuration ",(0,d.jsx)(i.code,{children:"appendfsync everysec"}),",  redis basically write data into memeory. However, pika uses rocksdb, which writes WAL on ssd druing every write batch. That comparation becomes multiple threads sequential write into ssd  and one thread write into memory."]}),"\n",(0,d.jsx)(i.p,{children:"Put the fairness or unfairness aside. Here is the performance."}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{src:"https://whoiami.github.io/public/images/images/CompareWithRedis.png",alt:""})}),"\n",(0,d.jsx)(i.h3,{id:"2-cluster-codis",children:"2. Cluster (Codis)"}),"\n",(0,d.jsx)(i.h4,{id:"21-topology",children:"2.1 Topology:"}),"\n",(0,d.jsx)(i.p,{children:"WithBInlog&Slave"}),"\n",(0,d.jsx)(i.p,{children:"4 machine * 2 pika instance (Master)"}),"\n",(0,d.jsx)(i.p,{children:"4 machine * 2 pika instance (Slave)"}),"\n",(0,d.jsx)(i.p,{children:"NoBinlog&Slave"}),"\n",(0,d.jsx)(i.p,{children:"4 machine * 2 pika instance (Master)"}),"\n",(0,d.jsx)(i.p,{children:"Slots Distribution:"}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{src:"https://whoiami.github.io/public/images/images/new_topo.png",alt:""})}),"\n",(0,d.jsx)(i.h4,{id:"22-withbinlogslave",children:"2.2 WithBinlog&Slave"}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{src:"https://whoiami.github.io/public/images/images/new_withbinlogslave.png",alt:"Set"})}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"Command"}),(0,d.jsx)(i.th,{children:"QPS"})]})}),(0,d.jsx)(i.tbody,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Set"}),(0,d.jsx)(i.td,{children:"1,400,000+"})]})})]}),"\n",(0,d.jsx)(i.h4,{id:"23-nobinlogslave",children:"2.3 NoBinlog&Slave"}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{src:"https://whoiami.github.io/public/images/images/new_nobinlog.png",alt:""})}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"Command"}),(0,d.jsx)(i.th,{children:"QPS"})]})}),(0,d.jsx)(i.tbody,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Set"}),(0,d.jsx)(i.td,{children:"1,600,000+"})]})})]}),"\n",(0,d.jsx)(i.h4,{id:"24-get-command",children:"2.4 Get Command"}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{src:"https://whoiami.github.io/public/images/images/new_get.png",alt:""})}),"\n",(0,d.jsxs)(i.table,{children:[(0,d.jsx)(i.thead,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.th,{children:"Command"}),(0,d.jsx)(i.th,{children:"QPS"})]})}),(0,d.jsx)(i.tbody,{children:(0,d.jsxs)(i.tr,{children:[(0,d.jsx)(i.td,{children:"Get"}),(0,d.jsx)(i.td,{children:"2,300,000+"})]})})]}),"\n",(0,d.jsx)(i.p,{children:"With or without binlog, for Get command, QPS is approximately the same."})]})}function j(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,d.jsx)(i,{...e,children:(0,d.jsx)(x,{...e})}):x(e)}},8453:(e,i,s)=>{s.d(i,{R:()=>r,x:()=>l});var d=s(6540);const n={},t=d.createContext(n);function r(e){const i=d.useContext(t);return d.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),d.createElement(t.Provider,{value:i},e.children)}}}]);